(this["webpackJsonpboulder-react"]=this["webpackJsonpboulder-react"]||[]).push([[0],{30:function(e,t,a){e.exports=a(43)},40:function(e,t,a){},41:function(e,t,a){},43:function(e,t,a){"use strict";a.r(t);var n,o=a(0),i=a.n(o),r=a(25),s=a.n(r),l=a(5),c=a(6),u=a(8),d=a(9),m=a(15),h=a(2),f=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(e){this.props.location!==e.location&&window.scrollTo(0,0)}},{key:"render",value:function(){return this.props.children}}]),a}(i.a.Component),b=Object(h.f)(f),k=(a(29),a(17)),p=a(16),v=a(14),g=a(10),y=a(28),j=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,null,[{key:"numberWithCommas",value:function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}},{key:"getCookie",value:function(e){var t="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===t.length)return t.pop().split(";").shift()}},{key:"getPrefObject",value:function(e){var t=window.localStorage.getItem(e);return console.log(t),null!=t&&void 0!=t&&t.length>0?JSON.parse(atob(t)):void 0}},{key:"setPrefObject",value:function(e,t){window.localStorage.setItem(e,btoa(JSON.stringify(t)))}},{key:"querify",value:function(e,t){var a,n=e+"?",o=Object(k.a)(t);try{for(o.s();!(a=o.n()).done;){var i=a.value;n+=null!=i[1]&&void 0!=i[1]?i[0]+"="+encodeURIComponent(i[1])+"&":""}}catch(r){o.e(r)}finally{o.f()}return n.slice(0,-1)}}]),e}(),_=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={},e}return Object(c.a)(a,[{key:"render",value:function(){return i.a.createElement("div",{className:"loading"},i.a.createElement("div",{className:"loading-circle"},i.a.createElement("div",{className:"loading-circle__item-background"}),i.a.createElement("div",{className:"loading-circle__item-3"}),i.a.createElement("div",{className:"loading-circle__item-2"}),i.a.createElement("div",{className:"loading-circle__item"})))}}]),a}(o.Component),O=a(27),E=function(e){var t,a=Object(O.useDoubleTap)((function(t){console.log("Double tapped"),e.onDoubleTap&&e.onDoubleTap()}));return i.a.createElement("img",Object.assign({},a,{src:e.src,alt:null!==(t=e.alt)&&void 0!==t?t:""}))},w=Object(y.a)(n=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={pageHeight:1e5,currentScrollPosition:0,subreddit:"",isBookmarksOpen:!1,titleMode:"view",bookmarks:[{subreddit:"",keyColor:"",nsfw:!1,images:{icon:""}}],savedPosts:[{name:"",title:"",image:""}]},n.bottomTriggerRef=i.a.createRef(),n.onScroll=n.onScroll.bind(Object(g.a)(n)),n.handleChange=n.handleChange.bind(Object(g.a)(n)),n.handleSearchEnter=n.handleSearchEnter.bind(Object(g.a)(n)),n.handlePostDoubleTap=n.handlePostDoubleTap.bind(Object(g.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e;window.addEventListener("scroll",this.onScroll),this.props.store.init(),this.setState({bookmarks:null!==(e=j.getPrefObject("ss"))&&void 0!==e?e:[]})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.onScroll)}},{key:"onScroll",value:function(e){this.bottomTriggerRef.current.getBoundingClientRect().bottom-window.innerHeight<2e3&&0==this.props.store.isLoading&&this.props.store.getNextPage()}},{key:"setTitleMode",value:function(e){this.setState((function(t){return Object(v.a)({},t,{titleMode:e})}))}},{key:"renderTitle",value:function(){var e=this;return"view"==this.state.titleMode?i.a.createElement("div",{key:"k",className:"nav-desktop__title",onClick:function(){return e.setTitleMode("edit")}},i.a.createElement("div",{className:"nav-desktop__title__icon",style:{backgroundImage:"url("+this.props.store.icon+")"}}),i.a.createElement("h4",null,"r/",this.props.store.subreddit),this.props.store.isNSFW?i.a.createElement("div",{className:"nav-desktop__title__nsfw"},"NSFW"):"",i.a.createElement("i",{class:"fas fa-pencil-alt"})):"edit"==this.state.titleMode?i.a.createElement("div",{key:"e",className:"nav-desktop__edit"},i.a.createElement("input",{type:"text",placeholder:"Enter a subreddit...",onKeyDown:this.handleSearchEnter,name:"subreddit",autoCapitalize:"off",onChange:this.handleChange}),i.a.createElement("div",{className:"nav-desktop__edit__button",onClick:function(){return e.handleSearch()}},i.a.createElement("i",{class:"fas fa-search"})),i.a.createElement("div",{className:"nav-desktop__edit__button",onClick:function(){return e.setTitleMode("view")}},i.a.createElement("i",{class:"fas fa-window-close"}))):void 0}},{key:"renderItems",value:function(){var e=this;return this.props.store.isInitialLoading?i.a.createElement(_,null):this.props.store.posts.map((function(t){var a=t.data.url,n={name:t.data.name,title:t.data.title,image:t.data.url};if(a.includes("jpg","png","gif","jpeg","bmp","tiff")&&!a.includes("/a/"))return i.a.createElement("div",{className:"posts__item"},i.a.createElement("p",null,t.data.title),i.a.createElement(E,{key:t.data.name,src:t.data.url,alt:"",onDoubleTap:function(){return e.handlePostDoubleTap(n)}}))}))}},{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.type,o=t.value,i="number"===n?parseFloat(o):o;this.setState(Object(p.a)({},a,i))}},{key:"handleSearch",value:function(){this.state.subreddit.length>3&&(window.scrollTo(0,0),this.props.store.setSubreddit(this.state.subreddit),this.props.store.fetchPosts(),this.setTitleMode("view"))}},{key:"handleBookmarksButton",value:function(){this.setState((function(e){return Object(v.a)({},e,{isBookmarksOpen:!e.isBookmarksOpen})}))}},{key:"handleBookmarksAddButton",value:function(){var e=this,t="",a="",n=!1,o="";this.props.store.getSubredditInfo(this.state.subreddit).then((function(e){t=e.data.icon_img,a=e.data.primary_color,n=e.data.over18,o=e.data.display_name}),(function(e){})).finally((function(){var i=t,r=a,s=n,l=o;e.setState((function(e){var t=e;return t.bookmarks.push({subreddit:l,keyColor:r,nsfw:s,images:{icon:i}}),t})),j.setPrefObject("ss",e.state.bookmarks)}))}},{key:"handleBookmarksRemoveButton",value:function(e){this.setState((function(t){var a=t.bookmarks.filter((function(t){return!(t.subreddit==e)}));return Object(v.a)({},t,{bookmarks:a})})),j.setPrefObject("ss",this.state.bookmarks)}},{key:"handleSearchEnter",value:function(e){"Enter"==e.key&&this.handleSearch()}},{key:"handlePostDoubleTap",value:function(e){console.log(e.name),this.setState((function(t){var a=t.savedPosts;return a.push(e),Object(v.a)({},t,{savedPosts:a})}))}},{key:"renderBookmarks",value:function(){var e=this;if(this.state.isBookmarksOpen){var t,a=[],n=0,o=Object(k.a)(this.state.bookmarks);try{var r=function(){var o=(s=t.value).subreddit;a.push(i.a.createElement("div",{key:n,className:"bookmarks__item"+(s.nsfw?" bookmarks__item--nsfw":"")},i.a.createElement("div",{className:"bookmarks__item__icon",onClick:function(){return e.handleBookmarkPress(o)},style:{backgroundImage:"url("+s.images.icon+")",backgroundColor:s.keyColor}}),i.a.createElement("div",{className:"bookmarks__item__subreddit",onClick:function(){return e.handleBookmarkPress(o)}},"r/",s.subreddit),i.a.createElement("div",{className:"bookmarks__item__remove",onClick:function(){return e.handleBookmarksRemoveButton(o)}},"X"))),n++};for(o.s();!(t=o.n()).done;){var s;r()}}catch(l){o.e(l)}finally{o.f()}return i.a.createElement("div",{className:"bookmarks"},a,i.a.createElement("div",{style:{height:"10px"}}),i.a.createElement("div",{className:"bookmarks__button"},"Backup bookmarks to clipboard"),i.a.createElement("div",{className:"bookmarks__button",onClick:function(){return e.handleClearBookmarks()}},"Clear bookmarks"))}}},{key:"handleBookmarkPress",value:function(e){this.props.store.setSubreddit(e),this.props.store.fetchPosts(),window.scrollTo(0,0),this.handleBookmarksButton()}},{key:"handleClearBookmarks",value:function(){j.setPrefObject("ss",[]),this.setState({bookmarks:[]})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,this.renderBookmarks(),i.a.createElement("div",{className:"nav"},i.a.createElement("div",{className:"nav-desktop"},i.a.createElement("div",{className:"nav-desktop__container"},i.a.createElement("div",{className:"nav-desktop__menu-button",onClick:function(){return e.handleBookmarksButton()}},i.a.createElement("i",{class:"fas fa-bars"})),this.renderTitle(),i.a.createElement("div",{className:"nav-desktop__add-button",onClick:function(){return e.handleBookmarksAddButton()}},i.a.createElement("i",{class:"fas fa-plus-circle"})))),i.a.createElement("div",{className:"nav-mobile"})),i.a.createElement("div",{className:"nav-desktop--spacer"}),i.a.createElement("div",{className:"posts"},i.a.createElement("div",{style:{height:"15px"}}),this.renderItems()),i.a.createElement("div",{key:"cokc",style:{position:"relative"},ref:this.bottomTriggerRef}))}}]),a}(o.Component))||n,S=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return i.a.createElement(m.a,null,i.a.createElement(b,null,i.a.createElement(h.c,null,i.a.createElement(h.a,{path:"/",exact:!0},i.a.createElement(w,{store:this.props.store})))))}}]),a}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(40),a(41);var N,B,C,P,T,I,L,D=a(11),M=a(12),W=(a(42),a(1)),R=(N=function(){function e(){Object(l.a)(this,e),this.subreddit="",this.endpoint="",Object(D.a)(this,"isNSFW",B,this),Object(D.a)(this,"icon",C,this),Object(D.a)(this,"isInitialLoading",P,this),Object(D.a)(this,"isLoading",T,this),Object(D.a)(this,"posts",I,this),Object(D.a)(this,"after",L,this)}return Object(c.a)(e,[{key:"init",value:function(){this.setSubreddit("gardening"),this.fetchPosts()}},{key:"setSubreddit",value:function(e){this.subreddit=e,this.endpoint="https://www.reddit.com/r/"+e+".json"}},{key:"fetchPosts",value:function(){var e=this;this.isInitialLoading=!0,this.getSubredditInfo(this.subreddit).then((function(t){e.icon=t.data.icon_img,e.isNSFW=t.data.over18}),(function(e){})).finally((function(){fetch(e.endpoint).then((function(e){return e.json()})).then((function(t){e.posts=[],e.after="",e.icon=t.data,t.data.children.map((function(t){var a=t;!a.data.url.includes("/imgur.com/")||a.data.url.includes(".jpg")||a.data.url.includes(".png")||(a.data.url+=".jpg",console.log(a.data.url)),e.posts.push(a)})),e.isInitialLoading=!1}),(function(e){}))}))}},{key:"getSubredditInfo",value:function(e){return new Promise((function(t,a){fetch("https://www.reddit.com/r/"+e+"/about.json").then((function(e){return e.json()})).then((function(e){t(e)}),(function(e){a(e)}))}))}},{key:"getNextPage",value:function(){var e=this;this.isLoading=!0,this.after=this.posts[this.posts.length-1].data.name,fetch(this.endpoint+"?after="+this.after).then((function(e){return e.json()})).then((function(t){t.data.children.map((function(t){var a=t;a.data.url.includes("/imgur.com/")&&(a.data.url+=".jpg",console.log(a.data.url)),e.posts.push(a)})),e.isLoading=!1}),(function(t){e.isLoading=!1}))}}]),e}(),B=Object(M.a)(N.prototype,"isNSFW",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),C=Object(M.a)(N.prototype,"icon",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),P=Object(M.a)(N.prototype,"isInitialLoading",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),T=Object(M.a)(N.prototype,"isLoading",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),I=Object(M.a)(N.prototype,"posts",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=Object(M.a)(N.prototype,"after",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),N),x=window.store=new R;s.a.render(i.a.createElement(S,{store:x}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[30,1,2]]]);
//# sourceMappingURL=main.b9b23a83.chunk.js.map